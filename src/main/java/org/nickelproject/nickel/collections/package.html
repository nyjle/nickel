This is alpha code, there are lots of likely performance issues here.

A specific question that this raises is what the interface to Source.partition should be.